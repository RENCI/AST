
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>harvester.fetch_adcirc_data &#8212; AST  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for harvester.fetch_adcirc_data</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># SPDX-FileCopyrightText: 2022 Renaissance Computing Institute. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: GPL-3.0-or-later</span>
<span class="c1"># SPDX-License-Identifier: LicenseRef-RENCI</span>
<span class="c1"># SPDX-License-Identifier: MIT</span>

<span class="c1">#</span>
<span class="c1"># A file suitable for use by ADDA,APSVIZ2,Reanalysis to fetch ADCIRC water levels from the ASGS</span>
<span class="c1"># The ASGS input to this class is a list of URLs. If you require running this by specifying TIMES, </span>
<span class="c1"># then you must preprocess the data into a list of URLs.</span>
<span class="c1">#</span>
<span class="c1"># TODO Check into the case where ADCIRC returns completely empty stations. This filtering may have been </span>
<span class="c1"># turned off n the Harvester codes.</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">harvester.fetch_station_data</span> <span class="k">import</span> <span class="n">adcirc_fetch_data</span>
<span class="kn">from</span> <span class="nn">utilities.utilities</span> <span class="k">import</span> <span class="n">utilities</span> <span class="k">as</span> <span class="n">utilities</span>

<span class="kn">import</span> <span class="nn">time</span> <span class="k">as</span> <span class="nn">tm</span>

<span class="c1"># Currently supported sources</span>
<span class="n">SOURCES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ASGS&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="get_adcirc_stations_fort63_style"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.get_adcirc_stations_fort63_style">[docs]</a><span class="k">def</span> <span class="nf">get_adcirc_stations_fort63_style</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This style of data input is required when using the fort63_style methods. Simply read a list of stations from a csv file.</span>
<span class="sd">    This gets read into a DataFrame. File MUST contain at least Node and stationid columns</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fname: &lt;str&gt; full path to a valid stationid file</span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: [stationid, Node]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No Fort63_style ADCIRC station file assigned: Abort&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;stationid&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;stationid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Unsuccessful fort63_station read. Perhaps no Node column ? </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="get_adcirc_stations_fort61_style"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.get_adcirc_stations_fort61_style">[docs]</a><span class="k">def</span> <span class="nf">get_adcirc_stations_fort61_style</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simply read a list of stations from a csv file. File MUST contain a stationid column</span>
<span class="sd">    Generally, we simply combine NOAA and Contrails into a single list. It is okay to include stations not likely to exist since</span>
<span class="sd">    the processing stage will simply remove them</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fname: &lt;str&gt; full path to a valid stationid file</span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: stationid</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No Fort63_style ADCIRC station file assigned: Abort&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;stationid&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;stationid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">adcirc_stations_list</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;stationid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="n">adcirc_stations</span><span class="o">=</span><span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">adcirc_stations_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">adcirc_stations</span></div>

<div class="viewcode-block" id="format_data_frames"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.format_data_frames">[docs]</a><span class="k">def</span> <span class="nf">format_data_frames</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Common formatting used by all sources</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_out</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">])</span>
    <span class="n">df_out</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;STATION&#39;</span><span class="p">,</span><span class="n">PRODUCT</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="n">df_out</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_out</span></div>

<span class="c1"># The hurricane methods are for the future</span>
<div class="viewcode-block" id="check_advisory"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.check_advisory">[docs]</a><span class="k">def</span> <span class="nf">check_advisory</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Try to determine if an advisory number was passed instead of a time value</span>

<span class="sd">    Parameters:</span>
<span class="sd">        value: &lt;str&gt; The time/adv word extracted form a url</span>
<span class="sd">        dformat: &lt;str&gt; format of the input str time </span>
<span class="sd">    Returns:</span>
<span class="sd">        state_hurricane: &lt;bool&gt; True if hurricane</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">state_hurricane</span><span class="o">=</span><span class="kc">False</span>
    <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Check advisory </span><span class="si">{value}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">test</span><span class="o">=</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">dformat</span><span class="p">)</span> <span class="c1"># &#39;%Y%m%d%H&#39;)</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;A timestamp data was found: Not a Hurricane advisory ? </span><span class="si">{test}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">outid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">state_hurricane</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Expected an Advisory value but could not convert to int </span><span class="si">{value}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;URL state_hurricane is </span><span class="si">{state_hurricane}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state_hurricane</span></div>

<div class="viewcode-block" id="check_if_hurricane"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.check_if_hurricane">[docs]</a><span class="k">def</span> <span class="nf">check_if_hurricane</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Very simple procedure but requires having the ASGS nomenclature. This will not work </span>
<span class="sd">    for generic locally stored files</span>
<span class="sd">    Only need to check one valid url from the list. This presumnes they all have the same</span>
<span class="sd">    grid, instance, class, etc</span>

<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str) A list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">        state_hurricane: &lt;bool&gt;  True if hurricane</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;time: URLs must be in list form&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">words</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">state_hurricane</span> <span class="o">=</span> <span class="n">check_advisory</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span>
            <span class="k">break</span>
        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;check_if_hurricane Uexpected failure try next:</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state_hurricane</span></div>

<span class="c1"># This is retained for backward compatability</span>
<span class="c1"># and is only used by this method&#39;s main</span>
<div class="viewcode-block" id="convert_input_url_to_nowcast"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.convert_input_url_to_nowcast">[docs]</a><span class="k">def</span> <span class="nf">convert_input_url_to_nowcast</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Though one could call this method using a nowcast url, occasionally we want to be able to</span>
<span class="sd">    only pass a forecast type url and, from that, figure out what the corresponding nowcast url might be.</span>
<span class="sd">    This assume a proper ASGS formatted url and makes no attempts to validate the </span>
<span class="sd">    the constructed url. Either it exists or this methiod exits(1)</span>

<span class="sd">    To use this feature:</span>
<span class="sd">    We mandate that the url is used to access ASGS data. The &quot;ensemble&quot; information must be in position .split(&#39;/&#39;)[-2]</span>

<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str) A list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">        urls: list(str) with all ensmble values set to &quot;nowcast&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;nowcast: URLs must be in list form&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">newurls</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
        <span class="n">urlwords</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">urlwords</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;nowcast&#39;</span>
        <span class="n">newurls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">urlwords</span><span class="p">))</span>
    <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Modified input URL to be a nowcast type&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newurls</span></div>

<span class="c1"># This is also retained for backward compatability</span>
<span class="c1"># and is only used by this method&#39;s main</span>
<div class="viewcode-block" id="combine_metadata_with_station_tuples"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.combine_metadata_with_station_tuples">[docs]</a><span class="k">def</span> <span class="nf">combine_metadata_with_station_tuples</span><span class="p">(</span><span class="n">df_meta</span><span class="p">,</span> <span class="n">station_nodes</span><span class="p">,</span> <span class="n">fort63_style</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Grabs the list of station tuples [(stationid,adcirc node)] and adds a </span>
<span class="sd">    column to the df_meta object</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df_meta: Input metadata dataframe stations x metadata</span>
<span class="sd">        station_nodes: list(str) list of stationids</span>
<span class="sd">        fort63_style: &lt;bool&gt; Value modifies the associated station Node value for prepending 63_ or 61_</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        df_meta: An improved ddata ataframe of entries stations x metadata</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_stations</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">station_nodes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STATION&#39;</span><span class="p">,</span><span class="s1">&#39;Node&#39;</span><span class="p">])</span>
    <span class="n">df_stations</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;STATION&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_stations</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_stations</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
    <span class="n">typ</span> <span class="o">=</span> <span class="s1">&#39;63_&#39;</span> <span class="k">if</span> <span class="n">fort63_style</span> <span class="k">else</span> <span class="s1">&#39;61_&#39;</span>
    <span class="n">df_stations</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">typ</span><span class="o">+</span><span class="n">df_stations</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span> <span class="c1"># Create something like 61-12345</span>
    <span class="n">df_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_meta</span><span class="p">,</span><span class="n">df_stations</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_meta</span></div>

<span class="c1">##</span>
<span class="c1">## Globals</span>
<span class="c1">##</span>
<span class="n">dformat</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span>
<span class="n">GLOBAL_TIMEZONE</span><span class="o">=</span><span class="s1">&#39;gmt&#39;</span> <span class="c1"># Every source is set or presumed to return times in the zone</span>
<span class="n">PRODUCT</span><span class="o">=</span><span class="s1">&#39;water_level&#39;</span>

<span class="c1">##</span>
<span class="c1">## Run stations. These functions generaly get called by outside callers</span>
<span class="c1">##</span>

<div class="viewcode-block" id="process_adcirc_stations"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.process_adcirc_stations">[docs]</a><span class="k">def</span> <span class="nf">process_adcirc_stations</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">adcirc_stations</span><span class="p">,</span> <span class="n">gridname</span><span class="p">,</span> <span class="n">ensemble</span><span class="p">,</span> <span class="n">sitename</span><span class="p">,</span> <span class="n">data_product</span><span class="o">=</span><span class="s1">&#39;water_level&#39;</span><span class="p">,</span> <span class="n">resample_mins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fort63_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s1">&#39;zeta&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to take an input list of times, stations, and product and return a data set and associated metadata set</span>

<span class="sd">    Parameters:</span>
<span class="sd">        urls: list&lt;str&gt;. Previously generated list of urls that span the desired time range </span>
<span class="sd">        stations: list(str). List of desired stations</span>
<span class="sd">        gridname: &lt;str&gt; gridname of the urls (opt)</span>
<span class="sd">        ensemble: &lt;str&gt; ensemble (opt)</span>
<span class="sd">        sitename &lt;str&gt;: sitename (opt)</span>
<span class="sd">        data_product: &lt;str&gt; (def data_product). An AST named data product (Not the True data product name) </span>
<span class="sd">        resample_mins: &lt;int&gt; Returned time series with a sampling of resample_mins</span>
<span class="sd">        fort63_style: &lt;bool&gt; Request fetching water levels from fort.63.nc/swan_HS.63.nc. Requires compatible station dataframe </span>
<span class="sd">        variable_nme: &lt;str&gt;  If wanting swan results,must pass in the correct NC4 data varable name of &#39;swan_HS&#39;</span>
<span class="sd">    Returns:</span>
<span class="sd">        df_adcirc_data: DataFrame (time x station)</span>
<span class="sd">        df_adcirc_meta: DataFrame (station x metadata)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Fetch the data</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_product</span> <span class="o">!=</span> <span class="s1">&#39;water_level&#39;</span><span class="p">:</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;ADCIRC data product can only be: water_level&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">adcirc</span> <span class="o">=</span> <span class="n">adcirc_fetch_data</span><span class="p">(</span><span class="n">adcirc_stations</span><span class="p">,</span> <span class="n">urls</span><span class="p">,</span> <span class="n">data_product</span><span class="p">,</span> <span class="n">sitename</span><span class="o">=</span><span class="n">sitename</span><span class="p">,</span> <span class="n">gridname</span><span class="o">=</span><span class="n">gridname</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ensemble</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="n">resample_mins</span><span class="o">=</span><span class="n">resample_mins</span><span class="p">,</span> <span class="n">fort63_style</span><span class="o">=</span><span class="n">fort63_style</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="n">variable_name</span><span class="p">)</span>
        <span class="n">df_adcirc_data</span> <span class="o">=</span> <span class="n">adcirc</span><span class="o">.</span><span class="n">aggregate_station_data</span><span class="p">()</span>
        <span class="n">df_adcirc_meta</span> <span class="o">=</span> <span class="n">adcirc</span><span class="o">.</span><span class="n">aggregate_station_metadata</span><span class="p">()</span>
        <span class="n">df_adcirc_meta</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;STATION&#39;</span>
        <span class="c1"># Add insitu found nodes for metadata</span>
        <span class="n">station_nodes</span> <span class="o">=</span> <span class="n">adcirc</span><span class="o">.</span><span class="n">available_stations_tuple</span>
        <span class="n">df_adcirc_meta</span><span class="o">=</span><span class="n">combine_metadata_with_station_tuples</span><span class="p">(</span><span class="n">df_adcirc_meta</span><span class="p">,</span> <span class="n">station_nodes</span><span class="p">,</span> <span class="n">fort63_style</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Error: ADCIRC: </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_adcirc_data</span><span class="p">,</span> <span class="n">df_adcirc_meta</span> </div>

<div class="viewcode-block" id="first_true"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.first_true">[docs]</a><span class="k">def</span> <span class="nf">first_true</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pred</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    itertools recipe found in the Python 3 docs</span>
<span class="sd">    Returns the first true value in the iterable.</span>
<span class="sd">    If no true value is found, returns *default*</span>
<span class="sd">    If *pred* is not None, returns the first item</span>
<span class="sd">    for which pred(item) is true.</span>

<span class="sd">    first_true([a,b,c], x) --&gt; a or b or c or x</span>
<span class="sd">    first_true([a,b], x, f) --&gt; a if f(a) else b if f(b) else x</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">iterable</span><span class="p">),</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="strip_time_from_url"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.strip_time_from_url">[docs]</a><span class="k">def</span> <span class="nf">strip_time_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We mandate that the URLs input to this fetcher are those used to access the ASGS data. The &quot;time&quot; information will be in position .split(&#39;/&#39;)[-6]</span>
<span class="sd">    eg. &#39;http://tds.renci.org/thredds/dodsC/2021/nam/2021052318/hsofs/hatteras.renci.org/hsofs-nam-bob-2021/nowcast/fort.63.nc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str). list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">         time: &lt;str&gt;: in either ASGS formatted &#39;%Y%m%d%H&#39; or possibly as a hurricane advisory string (to be checked later)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">grab_first_url_from_urllist</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">ttime</span><span class="o">=</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span> <span class="c1"># Always count from the back. NOTE if a hurrican this could be an advisory number.</span>
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;strip_time_from_url Uexpected failure try next:</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ttime</span></div>

<div class="viewcode-block" id="strip_ensemble_from_url"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.strip_ensemble_from_url">[docs]</a><span class="k">def</span> <span class="nf">strip_ensemble_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We mandate that the URLs input to this fetcher are those used to access the ASGS data. The &quot;ensemble&quot; information will be in position .split(&#39;/&#39;)[-2]</span>
<span class="sd">    eg. &#39;http://tds.renci.org/thredds/dodsC/2021/nam/2021052318/hsofs/hatteras.renci.org/hsofs-nam-bob-2021/nowcast/fort.63.nc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str). list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">        Ensemble: &lt;str&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">grab_first_url_from_urllist</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">ensemble</span><span class="o">=</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Usually nowcast,forecast, etc </span>
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;strip_ensemble_from_url Uexpected failure try next:</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ensemble</span></div>

<div class="viewcode-block" id="strip_instance_from_url"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.strip_instance_from_url">[docs]</a><span class="k">def</span> <span class="nf">strip_instance_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We mandate that the URLs input to this fetcher are those used to access the ASGS data. The &quot;instance&quot; information will be in position .split(&#39;/&#39;)[-3]</span>
<span class="sd">    eg. &#39;http://tds.renci.org/thredds/dodsC/2021/nam/2021052318/hsofs/hatteras.renci.org/hsofs-nam-bob-2021/nowcast/fort.63.nc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str). list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">        Instance: &lt;str&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">grab_first_url_from_urllist</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">instance</span><span class="o">=</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> 
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;strip_instance_from_url Uexpected failure try next:</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">instance</span> </div>

<div class="viewcode-block" id="strip_sitename_from_url"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.strip_sitename_from_url">[docs]</a><span class="k">def</span> <span class="nf">strip_sitename_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;NoSite&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Here we attempt to find which site the url was computed. We read the</span>
<span class="sd">    machine name from the url and lookup in the local dict for the predefined canonical site</span>
<span class="sd">    name. If no such name use the fill value</span>
<span class="sd">    The &quot;machine name&quot; information will be in position .split(&#39;/&#39;)[-4]. It may consist of multiple words.</span>
<span class="sd">    eg. &#39;http://tds.renci.org/thredds/dodsC/2021/nam/2021052318/hsofs/hatteras.renci.org/hsofs-nam-bob-2021/nowcast/fort.63.nc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str). list of valid urls</span>
<span class="sd">        fill: (str) manually specify the value for the sitename metadata</span>
<span class="sd">    Returns:</span>
<span class="sd">        canonical site name: (str) eg RENCI,PSC</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">known_sites</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hatteras.renci.org&#39;</span><span class="p">:</span><span class="s1">&#39;RENCI&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;bridges2.psc.edu&#39;</span><span class="p">:</span> <span class="s1">&#39;PSC&#39;</span><span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">grab_first_url_from_urllist</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">machine</span><span class="o">=</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> 
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;strip_sitename_from_url Uexpected failure try next:</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">site</span> <span class="o">=</span> <span class="n">known_sites</span><span class="p">[</span><span class="n">machine</span><span class="p">]</span> <span class="k">if</span> <span class="n">machine</span> <span class="ow">in</span> <span class="n">known_sites</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">fill</span>
    <span class="k">return</span> <span class="n">site</span></div>

<div class="viewcode-block" id="grab_gridname_from_url"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.grab_gridname_from_url">[docs]</a><span class="k">def</span> <span class="nf">grab_gridname_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We mandate that the URLs input to this fetcher are those used to access the ASGS data. The &quot;grid&quot; information will be in position .split(&#39;/&#39;)[-2]</span>
<span class="sd">    eg. &#39;http://tds.renci.org/thredds/dodsC/2021/nam/2021052318/hsofs/hatteras.renci.org/hsofs-nam-bob-2021/nowcast/fort.63.nc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str). list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">        grid.upper(): &lt;str&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">grab_first_url_from_urllist</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">=</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># Usually nowcast,forecast, etc </span>
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;strip_gridname_from_url Uexpected failure try next:</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span></div>

<div class="viewcode-block" id="grab_first_url_from_urllist"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.grab_first_url_from_urllist">[docs]</a><span class="k">def</span> <span class="nf">grab_first_url_from_urllist</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    eg. &#39;http://tds.renci.org/thredds/dodsC/2021/nam/2021052318/hsofs/hatteras.renci.org/hsofs-nam-bob-2021/nowcast/fort.63.nc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        urls: list(str). list of valid urls</span>
<span class="sd">    Returns:</span>
<span class="sd">        url: &lt;str&gt; . Fetch first available, valid url in the list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;first url: URLs must be in list form&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">first_true</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">url</span></div>

<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../harvester.html#harvester.fetch_adcirc_data.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We require the provided URL is using the typical ASGS nomenclature and that the timestamp is in (&#39;/&#39;) position -6</span>
<span class="sd">    Moreover, This time stamp behaves a little differently if fetching a nowcast versus a forecast (pre vs post). For now, we will</span>
<span class="sd">    annotate final .csv files with _TIME_ corresponding to the actual url data starttime.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">main_config</span> <span class="o">=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">init_logging</span><span class="p">(</span><span class="n">subdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_file</span><span class="o">=</span><span class="s1">&#39;../config/main.yml&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Return list of sources&#39;</span><span class="p">)</span>
         <span class="k">return</span> <span class="n">SOURCES</span>
         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">data_source</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">data_source</span>

    <span class="k">if</span> <span class="n">data_source</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">SOURCES</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Found selected data source </span><span class="si">{data_source}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Invalid data source </span><span class="si">{data_source}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">urls</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">urls</span>
    <span class="k">if</span> <span class="n">urls</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No URL was specified: Abort&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;urls: URLs must be in list form: Converting&#39;</span><span class="p">)</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">urls</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">convertToNowcast</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Requested conversion to Nowcast&#39;</span><span class="p">)</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="n">convert_input_url_to_nowcast</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>

    <span class="n">data_product</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">data_product</span>
    <span class="k">if</span> <span class="n">data_product</span> <span class="o">!=</span> <span class="s1">&#39;water_level&#39;</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;ADCIRC: The Only available data product is water_level: </span><span class="si">{data_product}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Chosen data source </span><span class="si">{data_source}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">variable_name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">variable_name</span>
    <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Selected variable name is </span><span class="si">{variable_name}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># If reading in a LOCAL url then we must skip the following steps</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">raw_local_url</span><span class="p">:</span>
        <span class="c1"># Check if this is a Hurricane</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">check_if_hurricane</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;URL is not a Hurricane advisory&#39;</span><span class="p">)</span>
            <span class="c1">#sys.exit(1)</span>
            <span class="n">urltimeStr</span> <span class="o">=</span> <span class="n">strip_time_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
            <span class="n">urltime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">urltimeStr</span><span class="p">,</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">)</span>
            <span class="n">runtime</span><span class="o">=</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">urltime</span><span class="p">,</span> <span class="n">dformat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;URL is a Hurricane&#39;</span><span class="p">)</span>
            <span class="n">urladvisory</span> <span class="o">=</span> <span class="n">strip_time_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
            <span class="n">runtime</span><span class="o">=</span><span class="n">urladvisory</span>
        <span class="n">ensemble</span> <span class="o">=</span> <span class="n">strip_ensemble_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>  <span class="c1"># Only need to check on of them</span>
        <span class="n">gridname</span> <span class="o">=</span> <span class="n">grab_gridname_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>   <span class="c1"># ditto</span>
        <span class="n">sitename</span> <span class="o">=</span> <span class="n">strip_sitename_from_url</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
        <span class="c1">#starttime=&#39;2021-12-08 12:00:00&#39;</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Selected run time/Advisory range is </span><span class="si">{runtime}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Raw url data structure specified&#39;</span><span class="p">)</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Running a RAW url type&#39;</span><span class="p">)</span>
        <span class="n">ensemble</span> <span class="o">=</span> <span class="s1">&#39;NONE&#39;</span>
        <span class="n">gridname</span> <span class="o">=</span> <span class="s1">&#39;NONE&#39;</span>
        <span class="n">sitename</span> <span class="o">=</span> <span class="s1">&#39;NONE&#39;</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">fort63_style</span><span class="p">:</span>
        <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Fort_63 style station inputs specified&#39;</span><span class="p">)</span>

    <span class="c1">##</span>
    <span class="c1">## Start the processing</span>
    <span class="c1">##</span>

    <span class="n">t0</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">data_source</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ASGS&#39;</span><span class="p">:</span>
        <span class="n">excludedStations</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Use default station list</span>
        <span class="n">fname_stations</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">station_list</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">station_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;../supporting_data/CERA_NOAA_HSOFS_stations_V3.1.csv&#39;</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">fort63_style</span><span class="p">:</span>
            <span class="n">adcirc_stations</span><span class="o">=</span><span class="n">get_adcirc_stations_fort63_style</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">fname_stations</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">adcirc_stations</span><span class="o">=</span><span class="n">get_adcirc_stations_fort61_style</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">fname_stations</span><span class="p">)</span>
        <span class="c1"># Need to specify something for the metadata </span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">raw_local_url</span><span class="p">:</span>
            <span class="n">adcirc_metadata</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ensemble</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">gridname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">runtime</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
            <span class="n">adcirc_metadata</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;_</span><span class="si">{ensemble}</span><span class="s2">_{gridname.upper()}_{runtime.replace(&#39; &#39;,&#39;T&#39;)}&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">adcirc_metadata</span><span class="o">=</span><span class="s1">&#39;Raw_data&#39;</span>

        <span class="n">data</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">process_adcirc_stations</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">adcirc_stations</span><span class="p">,</span> <span class="n">gridname</span><span class="p">,</span> <span class="n">ensemble</span><span class="p">,</span> <span class="n">sitename</span><span class="p">,</span> <span class="n">data_product</span><span class="p">,</span> <span class="n">resample_mins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fort63_style</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">fort63_style</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="n">variable_name</span><span class="p">)</span>
        <span class="c1">## df_adcirc_data = format_data_frames(data)</span>

        <span class="c1">## Skip the melt: Note this is only for the written file</span>
        <span class="n">df_adcirc_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="c1"># Output </span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">ofile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dataf</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/adcirc_stationdata</span><span class="si">%s</span><span class="s1">.csv&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">ofile</span><span class="p">,</span><span class="n">adcirc_metadata</span><span class="p">)</span>
                <span class="n">metaf</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/adcirc_stationdata_meta</span><span class="si">%s</span><span class="s1">.csv&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">ometafile</span><span class="p">,</span><span class="n">adcirc_metadata</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dataf</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;./adcirc_stationdata</span><span class="si">%s</span><span class="s1">.csv&#39;</span><span class="o">%</span><span class="n">adcirc_metadata</span>
                <span class="n">metaf</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;./adcirc_stationdata_meta</span><span class="si">%s</span><span class="s1">.csv&#39;</span><span class="o">%</span><span class="n">adcirc_metadata</span>
            <span class="n">df_adcirc_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">dataf</span><span class="p">)</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">metaf</span><span class="p">)</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;ADCIRC data has been stored </span><span class="si">{dataf}</span><span class="s1">,</span><span class="si">{metaf}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Error: ADCIRC: Failed Write </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">total_time</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
    <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Finished with data source </span><span class="si">{data_source}</span><span class="s1">. Time was </span><span class="si">{total_time}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">utilities</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finished&#39;</span><span class="p">)</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">argparse</span> <span class="k">import</span> <span class="n">ArgumentParser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--sources&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;List currently supported data sources&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--data_source&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;data_source&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;ASGS&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;choose supported data source: default = ASGS&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--urls&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ASGS url to fetcb ADCIRC data&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--data_product&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;data_product&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;water_level&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;choose supported data product: default is water_level&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--convertToNowcast&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Attempts to force input URL into a nowcast url assuming normal ASGS conventions&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--fort63_style&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> 
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Boolean: Will inform Harvester to use fort.63.methods to get station nodesids&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--station_list&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;station_list&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Choose a non-default location/filename for a stationlist&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ofile&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;ofile&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Choose a non-default data product output directory&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ometafile&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;ometafile&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Choose a non-default metadata output directory&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--raw_local_url&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Specify input url is locally stored&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--variable_name&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;variable_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;zeta&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Choose a non-default netCDF4 variable name&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">AST</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../harvester.html">harvester package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../processing.html">processing package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities.html">utilities package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, AST: AdcircSupportTools: RENCI EDS.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>